<div class="dashboard-root">
  <!-- Header Section -->
  <div class="dashboard-header">
    <h2 class="page-title">Overview</h2>
  </div>

  <!-- Stats Cards Grid -->
  <div class="stats-grid">
    <div class="stat-card" *ngFor="let stat of statCards">
      <div class="stat-icon" [attr.data-icon]="stat.icon">
        <!-- Users Icon -->
        <svg *ngIf="stat.icon === 'users'" width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M17 20C17 18.3431 14.7614 17 12 17C9.23858 17 7 18.3431 7 20M21 17C21 15.7635 19.6622 14.7112 17.8377 14.2479M3 17C3 15.7635 4.33784 14.7112 6.16228 14.2479M15 10C15 11.6569 13.6569 13 12 13C10.3431 13 9 11.6569 9 10C9 8.34315 10.3431 7 12 7C13.6569 7 15 8.34315 15 10ZM21 10C21 11.1046 20.1046 12 19 12C17.8954 12 17 11.1046 17 10C17 8.89543 17.8954 8 19 8C20.1046 8 21 8.89543 21 10ZM7 10C7 11.1046 6.10457 12 5 12C3.89543 12 3 11.1046 3 10C3 8.89543 3.89543 8 5 8C6.10457 8 7 8.89543 7 10Z" 
                stroke="#8B5CF6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <!-- Document Icon -->
        <svg *ngIf="stat.icon === 'document'" width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M9 12H15M9 16H15M17 21H7C5.89543 21 5 20.1046 5 19V5C5 3.89543 5.89543 3 7 3H12.5858C12.851 3 13.1054 3.10536 13.2929 3.29289L18.7071 8.70711C18.8946 8.89464 19 9.149 19 9.41421V19C19 20.1046 18.1046 21 17 21Z" 
                stroke="#8B5CF6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <!-- Image Icon -->
        <svg *ngIf="stat.icon === 'image'" width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M4 16L8.58579 11.4142C9.36683 10.6332 10.6332 10.6332 11.4142 11.4142L16 16M14 14L15.5858 12.4142C16.3668 11.6332 17.6332 11.6332 18.4142 12.4142L20 14M14 8H14.01M6 20H18C19.1046 20 20 19.1046 20 18V6C20 4.89543 19.1046 4 18 4H6C4.89543 4 4 4.89543 4 6V18C4 19.1046 4.89543 20 6 20Z" 
                stroke="#8B5CF6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <!-- Code Icon -->
        <svg *ngIf="stat.icon === 'code'" width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M17 17H17.01M15.6 14H18C18.9319 14 19.3978 14 19.7654 14.1522C20.2554 14.3552 20.6448 14.7446 20.8478 15.2346C21 15.6022 21 16.0681 21 17C21 17.9319 21 18.3978 20.8478 18.7654C20.6448 19.2554 20.2554 19.6448 19.7654 19.8478C19.3978 20 18.9319 20 18 20H6C5.06812 20 4.60218 20 4.23463 19.8478C3.74458 19.6448 3.35523 19.2554 3.15224 18.7654C3 18.3978 3 17.9319 3 17C3 16.0681 3 15.6022 3.15224 15.2346C3.35523 14.7446 3.74458 14.3552 4.23463 14.1522C4.60218 14 5.06812 14 6 14H8.4M12 4V12M12 12L15 9M12 12L9 9" 
                stroke="#8B5CF6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-title">{{ stat.title }}</div>
        <div class="stat-value">{{ stat.value }}</div>
        <div class="stat-footer">
          <span class="stat-period">{{ stat.period }}</span>
          <span class="stat-change" [class.positive]="stat.isPositive" [class.negative]="!stat.isPositive">
            <span class="change-icon">{{ stat.isPositive ? '↑' : '↓' }}</span>
            {{ stat.change }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="charts-grid">
    <!-- Bar Chart Card -->
    <div class="chart-card">
      <div class="chart-header">
        <h3 class="chart-title">Total New Users</h3>
        <div class="chart-controls">
          <select class="time-range-select" [(ngModel)]="selectedBarTimeRange">
            <option value="6 months">6 months</option>
            <option value="3 months">3 months</option>
            <option value="1 year">1 year</option>
          </select>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-y-axis">
          <span>7k</span>
          <span>6k</span>
          <span>5k</span>
          <span>4k</span>
          <span>3k</span>
          <span>2k</span>
          <span>1k</span>
        </div>
        <div class="bar-chart">
          <!-- Tooltip -->
          <div class="bar-tooltip" *ngIf="hoveredBarData" [style.left.%]="(hoveredBarIndex! / (barChartData.length - 1)) * 100">
            <div class="tooltip-content">
              <div class="tooltip-label">{{ hoveredBarData.label }}</div>
              <div class="tooltip-change" [class.positive]="hoveredBarData.isPositive">
                <span class="change-icon">{{ hoveredBarData.isPositive ? '↑' : '↓' }}</span>
                {{ hoveredBarData.change }} {{ hoveredBarData.text }}
              </div>
            </div>
          </div>
          
          <div class="bars-container">
            <div class="bar-wrapper" *ngFor="let data of barChartData; let i = index"
                 (mouseenter)="onBarHover(i, data)"
                 (mouseleave)="onBarLeave()">
              <div class="bar" 
                   [style.height.%]="getBarHeight(data.value)"
                   [class.hovered]="hoveredBarIndex === i">
              </div>
              <div class="bar-label">{{ data.month }}</div>
            </div>
          </div>
        </div>
      </div>
      <div class="chart-legend">
        <div class="legend-item">
          <span class="legend-dot"></span>
          <span class="legend-label">Total New Registered Users</span>
        </div>
      </div>
    </div>

    <!-- Line Chart Card -->
    <div class="chart-card">
      <div class="chart-header">
        <h3 class="chart-title">Total New Users</h3>
        <div class="chart-controls">
          <select class="time-range-select" [(ngModel)]="selectedLineTimeRange">
            <option value="15 days">15 days</option>
            <option value="7 days">7 days</option>
            <option value="30 days">30 days</option>
          </select>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-y-axis">
          <span>7k</span>
          <span>6k</span>
          <span>5k</span>
          <span>4k</span>
          <span>3k</span>
          <span>2k</span>
          <span>1k</span>
        </div>
        <div class="line-chart">
          <svg viewBox="0 0 100 100" preserveAspectRatio="none">
            <defs>
              <linearGradient *ngFor="let line of lineChartData" [attr.id]="'gradient-' + line.label" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" [attr.stop-color]="line.color" stop-opacity="0.2"/>
                <stop offset="100%" [attr.stop-color]="line.color" stop-opacity="0"/>
              </linearGradient>
            </defs>
            
            <!-- Grid lines -->
            <line *ngFor="let i of [0, 14.28, 28.56, 42.84, 57.12, 71.4, 85.68]" 
                  x1="0" [attr.y1]="i" x2="100" [attr.y2]="i" 
                  stroke="var(--border-color)" stroke-width="0.2"/>
            
            <!-- Lines -->
            <path *ngFor="let line of lineChartData"
                  [attr.d]="getLineChartPath(line.data)"
                  [attr.stroke]="line.color"
                  stroke-width="0.5"
                  fill="none"
                  class="chart-line"/>
            
            <!-- Data points -->
            <ng-container *ngFor="let line of lineChartData">
              <circle *ngFor="let point of line.data; let pointIndex = index"
                      [attr.cx]="getCirclePosition(pointIndex, point, line.data.length).x"
                      [attr.cy]="getCirclePosition(pointIndex, point, line.data.length).y"
                      r="0.8"
                      [attr.fill]="line.color"
                      class="data-point"/>
            </ng-container>
          </svg>
          <div class="line-chart-x-axis">
            <span *ngFor="let i of [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]">{{ i }}</span>
          </div>
        </div>
      </div>
      <div class="chart-legend">
        <div class="legend-item" *ngFor="let line of lineChartData">
          <span class="legend-dot" [style.background-color]="line.color"></span>
          <span class="legend-label">{{ line.label }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Tables Section -->
  <div class="tables-grid">
    <!-- Registrations Table -->
    <div class="table-card">
      <div class="table-header">
        <h3 class="table-title">Latest Registrations</h3>
      </div>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Status</th>
              <th>Reg. Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let reg of registrations">
              <td class="name-cell">{{ reg.name }}</td>
              <td>
                <span class="status-badge" [class.active]="reg.status === 'Active'" [class.pending]="reg.status === 'Pending'">
                  {{ reg.status }}
                </span>
              </td>
              <td class="date-cell">{{ reg.regDate }}</td>
              <td>
                <button class="action-btn">View</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Transactions Table -->
    <div class="table-card">
      <div class="table-header">
        <h3 class="table-title">Latest Transactions</h3>
        <button class="header-action">Last Month ↓</button>
      </div>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Paid By</th>
              <th>Package Name</th>
              <th>Price</th>
              <th>Status</th>
              <th>Paid Date</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let txn of transactions">
              <td class="name-cell">{{ txn.paidBy }}</td>
              <td>{{ txn.packageName }}</td>
              <td class="price-cell">{{ txn.price }}</td>
              <td>
                <span class="status-badge" [class.active]="txn.status === 'Active'" [class.expired]="txn.status === 'Expired'">
                  {{ txn.status }}
                </span>
              </td>
              <td class="date-cell">{{ txn.paidDate }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>